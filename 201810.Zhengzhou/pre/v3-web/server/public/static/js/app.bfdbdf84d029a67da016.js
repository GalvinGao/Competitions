webpackJsonp([1],{0:function(t,e){},"4kgl":function(t,e){},"A8f/":function(t,e){},HCE2:function(t,e){},NHnr:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=s("7+uW"),i={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("transition",{attrs:{name:"slide-fade",mode:"out-in"}},[e("router-view")],1),this._v(" "),e("div",{staticClass:"copyright"},[this._v("\n    Yiyang Gao 2018. Licensed under The Unlicense.\n  ")])],1)},staticRenderFns:[]};var a=s("VU/8")({name:"App"},i,!1,function(t){s("jDGw")},null,null).exports,o=s("grln"),r=s.n(o),l=(s("tvyh"),s("/ocq")),u=s("mvHQ"),c=s.n(u),d={name:"Index",data:function(){return{diaries:[],weekly:[],spinning:!1}},created:function(){this.fetchData()},methods:{fetchData:function(){var t=this;console.log(this),null===this.$cookie.get("token")&&this.$cookie.set("token","anonymous"),this.$http.get("http://localhost:3100/list?token="+this.$cookie.get("token")).then(function(e){t.diaries=JSON.parse(e.body.data).diary,t.weekly=JSON.parse(e.body.data).weekly},function(t){console.log("http error:<br>"+c()(t,null,2).toString())})},getDiaryHref:function(t){return"/diary/"+t},getWeeklyHref:function(t){return"/weekly/"+t},logout:function(){var t=this;this.$cookie.set("token","anonymous"),this.$cookie.set("role","",0),this.spinning=!0,this.$http.get("/logout").then(function(e){200===e.status&&(t.spinning=!1,t.$message.success("登出成功。正在刷新页面。 / status-"+e.status+", resp: "+e.body,4),document.location="/")},function(e){t.spinning=!1,t.$message.error("登出失败。请稍后再试 / status-"+e.status+", resp: "+e.body,4)})},comfirmGoAdmin:function(){this.$router.push("/login")}}},h={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"content"},[s("h1",[t._v("cms.min.js")]),t._v(" "),"admin"!==this.$cookie.get("role")?s("a-popconfirm",{attrs:{title:"非管理员账户。是否转到登录界面？",okText:"是的",cancelText:"不"},on:{confirm:t.comfirmGoAdmin}},[s("a-button",{staticClass:"admin",attrs:{type:"dashed",size:"small"}},[t._v("admin")])],1):s("router-link",{attrs:{to:"/admin/add"}},[s("a-button",{staticClass:"admin",attrs:{type:"dashed",size:"small"}},[t._v("admin")])],1),t._v(" "),t._m(0),t._v(" "),s("ul",{staticClass:"hello"},[t._l(t.diaries,function(e){return s("li",{key:e.id},[s("router-link",{staticClass:"list-btn",attrs:{to:t.getDiaryHref(e.hash)}},[t._v("\n        "+t._s(e.title)+" ("+t._s(e.date)+")\n      ")])],1)}),t._v(" "),0===this.diaries.length?s("a-alert",{attrs:{message:"暂无日记",type:"info",showIcon:""}}):t._e()],2),t._v(" "),s("hr"),t._v(" "),t._m(1),t._v(" "),s("ul",{staticClass:"hello"},[t._l(t.weekly,function(e){return s("li",{key:e.id},[s("router-link",{staticClass:"list-btn",attrs:{to:t.getWeeklyHref(e.hash)}},[t._v("\n        "+t._s(e.title)+" ("+t._s(e.date)+")\n      ")])],1)}),t._v(" "),0===this.diaries.length?s("a-alert",{attrs:{message:"暂无周总结报告",type:"info",showIcon:""}}):t._e()],2),t._v(" "),"string"==typeof this.$cookie.get("role")?s("div",[s("hr"),t._v(" "),s("a-spin",{attrs:{tip:"Logging out...",spinning:t.spinning}},[t._v("\n      已登录为 "),s("b",[t._v(t._s(this.$cookie.get("role")))]),t._v("。\n      "),s("a-button",{attrs:{type:"danger"},on:{click:t.logout}},[t._v("登出")])],1)],1):t._e()],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("h2",[this._v("日记"),e("span",{staticClass:"title-description"},[this._v("公开")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",[this._v("周总结"),e("span",{staticClass:"title-description"},[this._v("需要输入密码")])])}]};var p=s("VU/8")(d,h,!1,function(t){s("HCE2"),s("kPHE")},"data-v-1097fa58",null).exports,v={name:"Diary",data:function(){return{loading:!1,post:null,error:null,diary:null}},created:function(){this.fetchData()},watch:{$route:"fetchData"},methods:{fetchData:function(){var t=this;this.error=this.post=null,this.loading=!0,this.$http.get("/detail/diary/"+this.$route.params.id+"?token="+this.$cookie.get("token")).then(function(e){t.loading=!1,t.diary=JSON.parse(e.body.data);var s="";for(var n in t.diary.content.split("\n"))s+="<p>"+t.diary.content.split("\n")[n]+"</p>";t.diary.content=s},function(e){console.log(e.status),console.log(t),403===e.status&&t.$router.push("/login"),t.error="http error:<br>"+c()(e,null,2).toString()})}}},f={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"post"},[t.loading?s("div",{staticClass:"loading"},[t._v("\n    Loading...\n  ")]):t._e(),t._v(" "),t.error?s("div",{staticClass:"error",domProps:{innerHTML:t._s(t.error)}}):t._e(),t._v(" "),t.diary?s("div",{staticClass:"content"},[s("h2",{staticClass:"big-title"},[t._v("Diary")]),t._v(" "),s("router-link",{attrs:{to:"/"}},[s("h3",{staticClass:"back-button"},[t._v("返回")])]),t._v(" "),s("h1",{staticClass:"diary-title",domProps:{innerHTML:t._s(t.diary.title)}},[t._v("Loading...")]),t._v(" "),s("h3",{staticClass:"diary-date",domProps:{innerHTML:t._s(t.diary.date)}},[t._v("Loading...")]),t._v(" "),s("div",{staticClass:"diary-content",domProps:{innerHTML:t._s(t.diary.content)}},[t._v("\n      Loading...\n    ")])],1):t._e()])},staticRenderFns:[]};var j=s("VU/8")(v,f,!1,function(t){s("4kgl")},"data-v-1e7d832a",null).exports,m={name:"Diary",data:function(){return{loading:!1,post:null,error:null,diary:null}},created:function(){this.fetchData()},watch:{$route:"fetchData"},methods:{fetchData:function(){var t=this;this.error=this.post=null,this.loading=!0,this.$http.get("/detail/weekly/"+this.$route.params.id+"?token="+this.$cookie.get("token")).then(function(e){t.loading=!1,t.diary=JSON.parse(e.body.data);var s="";for(var n in t.diary.content.split("\n"))s+="<p>"+t.diary.content.split("\n")[n]+"</p>";t.diary.content=s},function(e){403===e.status&&t.$router.push("/login"),t.error="http error:<br>"+c()(e,null,2).toString()})}}},g={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"post"},[t.loading?s("div",{staticClass:"loading"},[t._v("\n    Loading...\n  ")]):t._e(),t._v(" "),t.error?s("div",{staticClass:"error",domProps:{innerHTML:t._s(t.error)}}):t._e(),t._v(" "),t.diary?s("div",{staticClass:"content"},[s("h2",{staticClass:"big-title"},[t._v("Weekly Report")]),t._v(" "),s("router-link",{attrs:{to:"/"}},[s("h3",{staticClass:"back-button"},[t._v("返回")])]),t._v(" "),s("h1",{staticClass:"diary-title",domProps:{innerHTML:t._s(t.diary.title)}},[t._v("Loading...")]),t._v(" "),s("h3",{staticClass:"diary-date",domProps:{innerHTML:t._s(t.diary.date)}},[t._v("Loading...")]),t._v(" "),s("div",{staticClass:"diary-content",domProps:{innerHTML:t._s(t.diary.content)}},[t._v("\n      Loading...\n    ")])],1):t._e()])},staticRenderFns:[]};var y=s("VU/8")(m,g,!1,function(t){s("A8f/")},"data-v-7fbae30a",null).exports,k={name:"Add",data:function(){return{loading:!1,post:null,error:null,diary:null,type:null,inputTitle:null,inputDate:null,inputContent:null,pushToken:null}},methods:{postNew:function(){var t=this;this.error=this.post=null,this.loading=!0,this.$http.post("/add?token="+this.pushToken,{title:this.inputTitle,type:this.type,date:this.inputDate,content:this.inputContent}).then(function(e){t.loading=!1},function(e){403===e.status&&t.$router.push("/login"),t.error="http error:<br>"+c()(e,null,2).toString()})}}},_={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"post"},[s("router-link",{attrs:{to:"/"}},[s("a-button",{attrs:{type:"primary"}},[s("a-icon",{attrs:{type:"left"}}),t._v("  返回")],1)],1),s("br"),s("br"),t._v(" "),s("h1",[t._v("Add new post")]),t._v(" "),s("a-select",{staticStyle:{width:"120px"},attrs:{defaultValue:"dairy"},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}},[s("a-select-option",{attrs:{value:"dairy"}},[t._v("Daily Report")]),t._v(" "),s("a-select-option",{attrs:{value:"weekly"}},[t._v("Weekly Report")])],1),s("br"),s("br"),t._v(" "),s("a-input",{attrs:{type:"text",id:"title",placeholder:"Title"},model:{value:t.inputTitle,callback:function(e){t.inputTitle=e},expression:"inputTitle"}}),s("br"),s("br"),t._v(" "),s("a-input",{attrs:{type:"text",id:"date",placeholder:"Date"},model:{value:t.inputDate,callback:function(e){t.inputDate=e},expression:"inputDate"}}),s("br"),s("br"),t._v(" "),s("a-textarea",{attrs:{id:"content",placeholder:"Content",autosize:{minRows:3}},model:{value:t.inputContent,callback:function(e){t.inputContent=e},expression:"inputContent"}}),s("br"),s("br"),t._v(" "),s("a-input",{attrs:{type:"text",id:"pushtoken",placeholder:"Password Confirmation"},model:{value:t.pushToken,callback:function(e){t.pushToken=e},expression:"pushToken"}}),s("br"),s("br"),t._v(" "),s("a-button",{attrs:{type:"primary",id:"submit"},on:{click:t.postNew}},[t._v("Submit")])],1)},staticRenderFns:[]};var b=s("VU/8")(k,_,!1,function(t){s("xbn+")},"data-v-ec3e055c",null).exports,w={name:"Login",data:function(){return{token:"",spinning:!1,delayTime:500}},methods:{login:function(){var t=this;this.error=this.post=null,this.spinning=!0,this.$http.get("/auth?token="+this.token).then(function(e){200===e.status?(t.$cookie.set("token",t.token),t.$cookie.set("role",JSON.parse(e.body.data).role),t.$message.success("User has been successfully authenticated. / 用户验证成功。",3),t.$message.success("token: "+t.token+"; role: "+JSON.parse(e.body.data).role,2),t.spinning=!1,t.$router.push("/")):(t.$message.error("Authentication failed due to invalid token. / 由于用户密码非法，权限验证失败。 / status-"+e.status,10),t.spinning=!1)},function(e){t.error="http error:<br>"+c()(e,null,2).toString()})}}},C={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"login"},[s("h1",[t._v("Authentication Required / 需要用户身份验证")]),t._v(" "),s("a-alert",{attrs:{message:"提供两种演示账号，分别对应两种用户：'admin' 可添加记录以及访问周总结；'demo' 仅可访问周总结。",type:"info",showIcon:""}}),t._v(" "),s("br"),t._v(" "),s("a-spin",{attrs:{spinning:t.spinning,delay:t.delayTime}},[s("a-input",{attrs:{type:"text",id:"title",placeholder:"密码"},model:{value:t.token,callback:function(e){t.token=e},expression:"token"}}),s("br"),s("br"),t._v(" "),s("a-button",{attrs:{type:"primary",id:"submit"},on:{click:t.login}},[t._v("登录")])],1)],1)},staticRenderFns:[]};var x=s("VU/8")(w,C,!1,function(t){s("dxL0")},"data-v-94177822",null).exports,z=s("8+8L");n.default.use(z.a),n.default.use(l.a);var L=new l.a({mode:"history",routes:[{path:"/",name:"Index",component:p},{path:"/diary/:id",name:"Diary by ID",component:j},{path:"/weekly/:id",name:"Weekly Report by ID",component:y},{path:"/admin/add",name:"Add new post",component:b},{path:"/login",name:"Login",component:x}]}),$=s("K/Lq"),D=s.n($);n.default.config.productionTip=!1,n.default.use(r.a),n.default.use(D.a),new n.default({el:"#app",router:L,components:{App:a},template:"<App/>"})},dxL0:function(t,e){},jDGw:function(t,e){},kPHE:function(t,e){},tvyh:function(t,e){},uslO:function(t,e,s){var n={"./af":"3CJN","./af.js":"3CJN","./ar":"3MVc","./ar-dz":"tkWw","./ar-dz.js":"tkWw","./ar-kw":"j8cJ","./ar-kw.js":"j8cJ","./ar-ly":"wPpW","./ar-ly.js":"wPpW","./ar-ma":"dURR","./ar-ma.js":"dURR","./ar-sa":"7OnE","./ar-sa.js":"7OnE","./ar-tn":"BEem","./ar-tn.js":"BEem","./ar.js":"3MVc","./az":"eHwN","./az.js":"eHwN","./be":"3hfc","./be.js":"3hfc","./bg":"lOED","./bg.js":"lOED","./bm":"hng5","./bm.js":"hng5","./bn":"aM0x","./bn.js":"aM0x","./bo":"w2Hs","./bo.js":"w2Hs","./br":"OSsP","./br.js":"OSsP","./bs":"aqvp","./bs.js":"aqvp","./ca":"wIgY","./ca.js":"wIgY","./cs":"ssxj","./cs.js":"ssxj","./cv":"N3vo","./cv.js":"N3vo","./cy":"ZFGz","./cy.js":"ZFGz","./da":"YBA/","./da.js":"YBA/","./de":"DOkx","./de-at":"8v14","./de-at.js":"8v14","./de-ch":"Frex","./de-ch.js":"Frex","./de.js":"DOkx","./dv":"rIuo","./dv.js":"rIuo","./el":"CFqe","./el.js":"CFqe","./en-au":"Sjoy","./en-au.js":"Sjoy","./en-ca":"Tqun","./en-ca.js":"Tqun","./en-gb":"hPuz","./en-gb.js":"hPuz","./en-ie":"ALEw","./en-ie.js":"ALEw","./en-il":"QZk1","./en-il.js":"QZk1","./en-nz":"dyB6","./en-nz.js":"dyB6","./eo":"Nd3h","./eo.js":"Nd3h","./es":"LT9G","./es-do":"7MHZ","./es-do.js":"7MHZ","./es-us":"INcR","./es-us.js":"INcR","./es.js":"LT9G","./et":"XlWM","./et.js":"XlWM","./eu":"sqLM","./eu.js":"sqLM","./fa":"2pmY","./fa.js":"2pmY","./fi":"nS2h","./fi.js":"nS2h","./fo":"OVPi","./fo.js":"OVPi","./fr":"tzHd","./fr-ca":"bXQP","./fr-ca.js":"bXQP","./fr-ch":"VK9h","./fr-ch.js":"VK9h","./fr.js":"tzHd","./fy":"g7KF","./fy.js":"g7KF","./gd":"nLOz","./gd.js":"nLOz","./gl":"FuaP","./gl.js":"FuaP","./gom-latn":"+27R","./gom-latn.js":"+27R","./gu":"rtsW","./gu.js":"rtsW","./he":"Nzt2","./he.js":"Nzt2","./hi":"ETHv","./hi.js":"ETHv","./hr":"V4qH","./hr.js":"V4qH","./hu":"xne+","./hu.js":"xne+","./hy-am":"GrS7","./hy-am.js":"GrS7","./id":"yRTJ","./id.js":"yRTJ","./is":"upln","./is.js":"upln","./it":"FKXc","./it.js":"FKXc","./ja":"ORgI","./ja.js":"ORgI","./jv":"JwiF","./jv.js":"JwiF","./ka":"RnJI","./ka.js":"RnJI","./kk":"j+vx","./kk.js":"j+vx","./km":"5j66","./km.js":"5j66","./kn":"gEQe","./kn.js":"gEQe","./ko":"eBB/","./ko.js":"eBB/","./ky":"6cf8","./ky.js":"6cf8","./lb":"z3hR","./lb.js":"z3hR","./lo":"nE8X","./lo.js":"nE8X","./lt":"/6P1","./lt.js":"/6P1","./lv":"jxEH","./lv.js":"jxEH","./me":"svD2","./me.js":"svD2","./mi":"gEU3","./mi.js":"gEU3","./mk":"Ab7C","./mk.js":"Ab7C","./ml":"oo1B","./ml.js":"oo1B","./mn":"CqHt","./mn.js":"CqHt","./mr":"5vPg","./mr.js":"5vPg","./ms":"ooba","./ms-my":"G++c","./ms-my.js":"G++c","./ms.js":"ooba","./mt":"oCzW","./mt.js":"oCzW","./my":"F+2e","./my.js":"F+2e","./nb":"FlzV","./nb.js":"FlzV","./ne":"/mhn","./ne.js":"/mhn","./nl":"3K28","./nl-be":"Bp2f","./nl-be.js":"Bp2f","./nl.js":"3K28","./nn":"C7av","./nn.js":"C7av","./pa-in":"pfs9","./pa-in.js":"pfs9","./pl":"7LV+","./pl.js":"7LV+","./pt":"ZoSI","./pt-br":"AoDM","./pt-br.js":"AoDM","./pt.js":"ZoSI","./ro":"wT5f","./ro.js":"wT5f","./ru":"ulq9","./ru.js":"ulq9","./sd":"fW1y","./sd.js":"fW1y","./se":"5Omq","./se.js":"5Omq","./si":"Lgqo","./si.js":"Lgqo","./sk":"OUMt","./sk.js":"OUMt","./sl":"2s1U","./sl.js":"2s1U","./sq":"V0td","./sq.js":"V0td","./sr":"f4W3","./sr-cyrl":"c1x4","./sr-cyrl.js":"c1x4","./sr.js":"f4W3","./ss":"7Q8x","./ss.js":"7Q8x","./sv":"Fpqq","./sv.js":"Fpqq","./sw":"DSXN","./sw.js":"DSXN","./ta":"+7/x","./ta.js":"+7/x","./te":"Nlnz","./te.js":"Nlnz","./tet":"gUgh","./tet.js":"gUgh","./tg":"5SNd","./tg.js":"5SNd","./th":"XzD+","./th.js":"XzD+","./tl-ph":"3LKG","./tl-ph.js":"3LKG","./tlh":"m7yE","./tlh.js":"m7yE","./tr":"k+5o","./tr.js":"k+5o","./tzl":"iNtv","./tzl.js":"iNtv","./tzm":"FRPF","./tzm-latn":"krPU","./tzm-latn.js":"krPU","./tzm.js":"FRPF","./ug-cn":"To0v","./ug-cn.js":"To0v","./uk":"ntHu","./uk.js":"ntHu","./ur":"uSe8","./ur.js":"uSe8","./uz":"XU1s","./uz-latn":"/bsm","./uz-latn.js":"/bsm","./uz.js":"XU1s","./vi":"0X8Q","./vi.js":"0X8Q","./x-pseudo":"e/KL","./x-pseudo.js":"e/KL","./yo":"YXlc","./yo.js":"YXlc","./zh-cn":"Vz2w","./zh-cn.js":"Vz2w","./zh-hk":"ZUyn","./zh-hk.js":"ZUyn","./zh-tw":"BbgG","./zh-tw.js":"BbgG"};function i(t){return s(a(t))}function a(t){var e=n[t];if(!(e+1))throw new Error("Cannot find module '"+t+"'.");return e}i.keys=function(){return Object.keys(n)},i.resolve=a,t.exports=i,i.id="uslO"},"xbn+":function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.bfdbdf84d029a67da016.js.map